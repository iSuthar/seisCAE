# ============================================================================
# seisCAE Default Configuration
# ============================================================================
# This is the default configuration file for seisCAE.
# Copy and modify this file for your specific use case.
#
# Author: Ankit Suthar
# Date: 2025-11-02
# ============================================================================

# Event Detection Parameters
# ---------------------------
# Updated to match research paper defaults
detection:
  sta_seconds: 0.5              # Short-term average window (seconds)
  lta_seconds: 30.0             # Long-term average window (seconds)
  threshold_on: 10.0            # Trigger ON threshold (STA/LTA ratio) - RESEARCH PAPER VALUE
  threshold_off: 3.0            # Trigger OFF threshold (STA/LTA ratio)
  sampling_rate: 100.0          # Expected sampling rate (Hz)
  highpass_freq: 1.0            # Highpass filter frequency (Hz), null to disable
  method: "classic"             # Detection method: "classic" or "multi_window"
  delta_sta: 20.0               # STA window ratio (multi_window only)
  delta_lta: 20.0               # LTA window ratio (multi_window only)
  epsilon: 2.0                  # Adjacent window ratio (multi_window only)
  min_event_duration: 0.0       # Minimum event duration filter (seconds, 0 = no filter)
  dead_time: 0.0                # Minimum time between events (seconds, 0 = no filter)

# Spectrogram Generation Parameters
# ----------------------------------
# Updated to match research paper defaults
spectrogram:
  nperseg: 128                  # STFT segment length (128 for 100Hz data, 512 for 500Hz data)
  noverlap_ratio: 0.9           # Overlap ratio (0.0 - 1.0) - 90% overlap
  nfft: 512                     # FFT length
  freq_min: 1.0                 # Minimum frequency (Hz)
  freq_max: 50.0                # Maximum frequency (Hz)
  time_bins: 40                 # Target number of time bins - RESEARCH PAPER VALUE
  freq_bins: 256                # Target number of frequency bins - RESEARCH PAPER VALUE
  window_seconds: 4.0           # Time window for spectrogram (seconds) - centered on max energy

# Model Architecture Parameters
# ------------------------------
model:
  architecture: conv_ae         # Model architecture (conv_ae, resnet_ae, vae)
  latent_dim: 16                # Latent space dimensionality
  dropout: 0.1                  # Dropout probability (0.0 - 1.0)
  input_channels: 1             # Number of input channels

# Training Parameters
# -------------------
training:
  epochs: 300                   # Maximum number of training epochs
  batch_size: 128               # Batch size for training
  learning_rate: 0.0001         # Learning rate (1e-4)
  patience: 20                  # Early stopping patience (epochs)
  validation_split: 0.3         # Validation split ratio (0.0 - 1.0)
  num_workers: 4                # Number of DataLoader workers
  save_frequency: 10            # Save checkpoint every N epochs

# Clustering Parameters
# ---------------------
# Updated to match research paper methodology
clustering:
  algorithm: gmm                # Clustering algorithm (gmm, kmeans, dbscan)
  n_clusters: 50                # Number of clusters - RESEARCH PAPER VALUE (50 for fine-grain clustering)
  covariance_type: full         # GMM covariance type (full, tied, diag, spherical) - RESEARCH PAPER VALUE
  random_state: 42              # Random seed for reproducibility

# Phase 3 Post-Clustering Analysis
# ---------------------------------
# Research paper Phase 3: compute physical metrics for manual cluster merging
phase3:
  compute_metrics: true         # Compute peak_freq, freq_dominance, temporal_concentration, temporal_mad
  export_excel: true            # Export complete analysis to Excel (research paper format)
  suggest_merges: true          # Suggest cluster pairs to merge based on metric similarity
  merge_threshold: 0.2          # Similarity threshold for merge suggestions (0.0-1.0, lower = more similar)

# Visualization Parameters
# ------------------------
visualization:
  dpi: 300                      # Figure DPI (dots per inch)
  format: png                   # Figure format (png, pdf, svg)
  examples_per_cluster: 5       # Number of examples to show per cluster
  colormap: OrRd                # Colormap for spectrograms
  # Training diagnostics
  training_diagnostics: true    # Generate training diagnostic plots
  plot_loss_curves: true        # Detailed loss curves with best epoch marker
  plot_reconstructions: true    # Original vs reconstructed spectrograms
  plot_latent_evolution: false  # t-SNE evolution (requires saving features at multiple epochs)
  # Clustering diagnostics
  clustering_diagnostics: true  # Generate clustering diagnostic plots
  plot_cluster_grids: true      # Multi-panel cluster examples (waveform|spec|recon|freq_profile)
  plot_feature_heatmap: true    # Phase 3 metrics heatmap across clusters
  plot_distance_distributions: true  # Per-cluster distance to center histograms

# Input/Output Parameters
# -----------------------
io:
  output_base: ./results        # Base output directory
  save_waveforms: true          # Save extracted waveforms
  save_spectrograms: true       # Save spectrograms as .npy
  save_diagnostics: true        # Save diagnostic plots
  catalog_format: pkl           # Catalog format (pkl, csv, h5)
  file_pattern: "*"             # File pattern for detection (e.g., "*.mseed", "*.sac", "*")
  recursive_search: false       # Recursively search subdirectories for data files

# Seismic Components to Process
# -----------------------------
components:
  - EHZ                         # Vertical component (Z)
  # - EHN                       # North component (N)
  # - EHE                       # East component (E)
  # - HHZ                       # High-gain vertical
  # - BHZ                       # Broadband vertical

# Hardware Parameters
# -------------------
hardware:
  gpu: -1                       # GPU ID (-1 for CPU, 0+ for specific GPU)
  mixed_precision: false        # Use mixed precision training (requires GPU)
  deterministic: true           # Use deterministic algorithms (slower but reproducible)

# Logging Parameters
# ------------------
logging:
  level: INFO                   # Logging level (DEBUG, INFO, WARNING, ERROR)
  log_file: null                # Log file path (null for console only)
  format: "%(asctime)s | %(name)s | %(levelname)s | %(message)s"

# Advanced Options
# ----------------
advanced:
  feature_normalization: standard  # Feature normalization (standard, minmax, none)
  augmentation: false           # Data augmentation (experimental)
  ensemble_models: 1            # Number of ensemble models (1 = no ensemble)
